<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, interactive-widget=resizes-content">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <script>
        // Update theme-color immediately based on localStorage
        (function() {
            try {
                const savedTheme = localStorage.getItem('theme');
                const themeColorMeta = document.querySelector('meta[name="theme-color"]');
                const appleStatusBarMeta = document.querySelector('meta[name="apple-mobile-web-app-status-bar-style"]');
                
                if (savedTheme === 'light' && themeColorMeta && appleStatusBarMeta) {
                    themeColorMeta.setAttribute('content', '#ffffff');
                    appleStatusBarMeta.setAttribute('content', 'default');
                }
            } catch(e) {}
        })();
    </script>
    <title>Pricing - InfiNet AI</title>
    <style>
        :root {
            --bg-primary: #000000;
            --bg-secondary: #121212;
            --bg-tertiary: #1a1a1a;
            --accent: #e5ff3a;
            --accent-hover: #b8cc2e;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --text-muted: #888888;
            --border: #333333;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            min-height: calc(100vh + 1px);
            overflow-y: scroll;
            -webkit-overflow-scrolling: touch;
            display: flex;
        }

        html {
            background-color: #000000;
        }

        @media (max-width: 768px) {
            body {
                height: auto !important;
                min-height: 100dvh;
                overflow-y: auto !important;
                overflow-x: hidden;
                position: relative;
                display: flex;
                /* Restore flex layout */
                flex-direction: column;
                /* Ensure vertical stacking on mobile */
            }
        }



        /* Sidebar */
        .sidebar {
            width: 280px;
            flex-shrink: 0;
            background: var(--bg-secondary);
            border-right: none;
            display: flex;
            flex-direction: column;
            height: 100vh;
            transition: transform 0.3s ease;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 1000;
            transform: translateX(-100%);
        }

        .sidebar.sidebar-open {
            transform: translateX(0);
        }

        .sidebar.mobile-hidden {
            transform: translateX(-100%);
        }

        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 99;
        }

        .sidebar-overlay.show {
            display: block;
        }

        /* Sidebar Bot Handle */
        .sidebar-handle {
            position: absolute;
            right: -45px;
            top: 80px;
            width: 60px;
            height: 80px;
            cursor: pointer;
            z-index: 101;
            transition: all 0.3s ease;
            filter: drop-shadow(0 4px 8px rgba(229, 255, 58, 0.4));
        }

        .sidebar-handle svg {
            width: 100%;
            height: 100%;
            transition: all 0.3s ease;
        }

        .sidebar-handle:hover {
            right: -50px;
            filter: drop-shadow(0 6px 15px rgba(229, 255, 58, 0.7));
            animation: botBounce 0.6s ease-in-out infinite;
        }

        .sidebar-handle:hover svg {
            transform: scale(1.1);
        }

        .sidebar-handle:hover .bot-head {
            animation: botPeek 0.8s ease-in-out infinite;
        }

        .sidebar-handle:hover .bot-hand-left {
            animation: handWave 0.5s ease-in-out infinite;
            transform-origin: top center;
        }

        .sidebar-handle:hover .bot-hand-right {
            animation: handWave 0.5s ease-in-out infinite 0.25s;
            transform-origin: top center;
        }

        .sidebar-handle:hover .bot-eye {
            animation: eyeBlink 2s ease-in-out infinite;
        }

        @keyframes botBounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-5px);
            }
        }

        @keyframes botPeek {
            0%, 100% {
                transform: translateX(0);
            }
            50% {
                transform: translateX(3px);
            }
        }

        @keyframes handWave {
            0%, 100% {
                transform: rotate(0deg);
            }
            50% {
                transform: rotate(15deg);
            }
        }

        @keyframes eyeBlink {
            0%, 90%, 100% {
                transform: scaleY(1);
            }
            95% {
                transform: scaleY(0.1);
            }
        }

        .sidebar.sidebar-open .sidebar-handle {
            right: -45px;
        }

        .sidebar-header {
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .sidebar-header img {
            width: 40px;
            height: 40px;
            border-radius: 8px;
        }

        .sidebar-header h1 {
            font-size: 1.25rem;
            color: var(--accent);
            font-weight: 700;
            margin: 0;
            line-height: 1.2;
        }

        .sidebar-actions {
            padding: 1rem;
        }

        .btn-go-uncensored {
            width: 100%;
            padding: 0.75rem;
            background: var(--accent);
            color: var(--bg-primary);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem;
        }

        .btn-go-uncensored:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .sidebar-conversations {
            flex: 1;
            overflow-y: auto;
            padding: 0.5rem;
        }

        .conversation-item {
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 0.25rem;
            transition: all 0.2s;
            color: var(--text-secondary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            position: relative;
        }

        .conversation-item:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .conversation-item.active {
            background: var(--bg-tertiary);
            color: var(--accent);
        }

        .conversation-item-content {
            flex: 1;
            min-width: 0;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .conversation-delete-btn {
            opacity: 0;
            transition: opacity 0.2s;
            padding: 0.25rem;
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            border-radius: 4px;
            flex-shrink: 0;
        }

        .conversation-item:hover .conversation-delete-btn {
            opacity: 1;
        }

        .conversation-delete-btn:hover {
            color: #ff4444;
            background: rgba(255, 68, 68, 0.1);
        }

        .conversation-delete-btn svg {
            width: 14px;
            height: 14px;
            fill: currentColor;
        }

        .conversation-item {
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 0.25rem;
            transition: all 0.2s;
            color: var(--text-secondary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .conversation-item:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .conversation-item.active {
            background: var(--bg-tertiary);
            color: var(--accent);
        }

        .sidebar-info-cards {
            padding: 0.4rem 0.5rem;
            border-top: none;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .sidebar-info-cards .info-card {
            padding: 0.7rem 0.75rem;
            margin: 0;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            z-index: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .sidebar-info-cards .info-card:hover,
        .sidebar-info-cards .info-card.expanded-active {
            z-index: 1001;
        }

        .sidebar-info-cards .info-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .sidebar-info-cards .info-card:active {
            transform: scale(0.98);
        }

        .sidebar-info-cards .info-card h4 {
            font-size: 0.85rem;
            margin-bottom: calc(0.2rem + 0.95mm);
            margin-top: 0;
            color: var(--accent);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            line-height: 1.1;
        }

        .sidebar-info-cards .info-card p {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.3;
        }

        .sidebar-info-cards .info-card .lock-icon {
            width: 14px;
            height: 14px;
            flex-shrink: 0;
            fill: currentColor;
        }

        .info-card-expanded {
            display: none;
            position: absolute;
            top: 0;
            left: calc(100% + 0.5rem);
            background: var(--bg-tertiary);
            border: 1px solid var(--accent);
            border-radius: 8px;
            padding: 0.625rem;
            z-index: 1002;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            width: 200px;
            max-width: calc(100vw - 2rem);
        }

        .sidebar-info-cards .info-card-expanded {
            left: calc(100% + 0.5rem);
        }

        .info-card-expanded.show {
            display: block;
            animation: slideDown 0.2s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .info-card-expanded-header {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            margin-bottom: 0.4rem;
        }

        .info-card-expanded-header svg {
            width: 14px;
            height: 14px;
            fill: var(--accent);
            flex-shrink: 0;
        }

        .info-card-expanded-header h5 {
            color: var(--accent);
            font-size: 0.8rem;
            font-weight: 600;
            margin: 0;
        }

        .info-card-expanded p {
            color: var(--text-secondary);
            font-size: 0.7rem;
            line-height: 1.4;
            margin: 0;
        }

        .sidebar-footer {
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .sidebar-footer a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.85rem;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sidebar-footer a .sidebar-icon {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
            fill: currentColor;
        }

        .sidebar-footer a:hover {
            color: var(--accent);
            background: var(--bg-tertiary);
        }

        .theme-toggle {
            padding: 0.5rem;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            margin-top: 0.5rem;
        }

        .theme-toggle:hover {
            border-color: var(--accent);
            color: var(--accent);
            background: var(--bg-tertiary);
        }

        .theme-toggle svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        .sidebar-socials {
            padding: 0.75rem 1rem calc(3rem + 1cm);
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .sidebar-socials .sidebar-cta-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5mm;
        }

        .sidebar-socials .sidebar-cta {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.4rem;
            padding: 0.45rem 1.25rem;
            border-radius: 8px;
            border: 1px solid #e5ff3a;
            background: #e5ff3a;
            color: #000000;
            transition: all 0.2s;
            text-decoration: none;
            font-size: 0.8rem;
            font-weight: 600;
            line-height: 1;
            white-space: nowrap;
        }

        .sidebar-socials .sidebar-cta:hover {
            color: #000000;
            border-color: #b8cc2e;
            background: #b8cc2e;
        }

        .sidebar-socials .sidebar-cta svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
            flex-shrink: 0;
        }

        .sidebar-socials .sidebar-link-text {
            color: #e5ff3a;
            font-weight: bold;
            text-decoration: none;
            font-size: 0.85rem;
            transition: opacity 0.2s;
        }

        .sidebar-socials .sidebar-link-text:hover {
            opacity: 0.8;
        }

        /* Main Layout */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background: var(--bg-primary);
            overflow-y: auto;
            overflow-x: hidden;
            min-width: 0;

            @media (max-width: 768px) {
                .main-content {
                    height: auto !important;
                    min-height: 100dvh;
                    overflow: visible !important;
                    overflow: visible !important;
                    flex: none;
                    display: flex;
                    /* Restore flex layout */
                    flex-direction: column;
                }
            }
        }
        
        /* Ensure footer stays at bottom on desktop */
        @media (min-width: 769px) {
            .main-content {
                min-height: 100vh;
                height: auto;
            }
            
            .page {
                flex: 1;
                display: flex;
                flex-direction: column;
            }
            
            .chat-footer {
                margin-top: auto;
            }
        }



        .page {
            width: 100%;
            max-width: 1100px;
            padding: 2rem 1.5rem 3rem;
            margin: 0 auto;
            box-sizing: border-box;
        }

        /* Pricing page content */
        .header {
            text-align: center;
            margin-bottom: 2rem;
            margin-top: 5mm;
        }

        .header h1 {
            color: var(--accent);
            margin: 0 0 0.5rem;
        }

        .header p {
            color: var(--text-secondary);
            margin: 0;
        }

        .plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 280px));
            gap: 1rem;
            justify-content: center;
        }

        .plan {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.2s;
        }

        .plan:hover {
            border-color: var(--accent);
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.35);
        }

        .plan h2 {
            margin: 0;
            font-size: 1.1rem;
            color: var(--accent);
        }

        .price {
            font-size: 1.6rem;
            font-weight: 700;
        }

        .price span {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .features {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .cta {
            margin-top: auto;
            padding: 0.65rem 0.75rem;
            border-radius: 10px;
            border: 1px solid var(--accent);
            background: var(--accent);
            color: var(--bg-primary);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .cta:hover {
            background: var(--accent-hover);
            border-color: var(--accent-hover);
        }

        .plan.muted .cta {
            background: transparent;
            color: var(--accent);
        }

        .plan.muted .cta:hover {
            background: rgba(229, 255, 58, 0.1);
        }

        /* Token Usage Section */
        #token-usage-wrapper {
            margin-bottom: 2rem;
            max-width: 350px;
            margin-left: auto;
            margin-right: auto;
        }

        .token-usage-title {
            color: var(--accent);
            text-align: center;
            margin: 0 0 0.75rem 0;
            font-size: 1.1rem;
        }

        .token-usage-section {
            /* Card styling removed - keeping content only */
            display: block;
        }

        .token-usage-header {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 0.6rem;
        }

        .token-usage-stats {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-align: center;
        }

        .token-usage-bar-container {
            margin-bottom: 0.4rem;
        }

        .token-usage-bar {
            width: 100%;
            height: 12px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            overflow: hidden;
        }

        .token-usage-bar-fill {
            height: 100%;
            background: var(--accent);
            border-radius: 6px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .token-usage-numbers {
            text-align: center;
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: 0;
                top: 0;
                width: 280px;
                box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
                z-index: 1000;
            }

            .sidebar.mobile-hidden {
                transform: translateX(-100%);
            }

            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.sidebar-open {
                transform: translateX(0);
            }

            .main-content {
                width: 100%;
            }

            .info-card-expanded {
                position: absolute;
                top: 0;
                left: 50%;
                transform: translateX(-50%);
                width: 180px;
                max-width: calc(100vw - 2rem);
                max-height: 60vh;
                overflow-y: auto;
                padding: 0.625rem;
                border-radius: 8px;
            }

            .info-card-expanded.show {
                animation: fadeIn 0.2s ease;
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                }

                to {
                    opacity: 1;
                }
            }
        }

        /* Footer */
        .chat-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 3rem auto 0;
            padding: 2rem 1.5rem 2rem;
            position: relative;
            background: transparent;
            width: 100%;
            box-sizing: border-box;
        }

        .footer-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            color: var(--text-secondary);
            transition: all 0.2s;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: transparent;
            text-decoration: none;
        }

        .footer-link:hover {
            color: var(--accent);
            border-color: var(--accent);
            background: var(--bg-tertiary);
            transform: scale(1.05);
        }

        .footer-link svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        .footer-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
        }

        .footer-text {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .footer-copyright {
            color: var(--text-muted);
            font-size: 0.75rem;
            margin: 0;
            margin-top: 0.5rem;
        }

        .footer-logo {
            width: 42px;
            height: 42px;
            border-radius: 6px;
            object-fit: cover;
            vertical-align: middle;
            margin-left: -1mm;
        }

        @media (max-width: 768px) {
            .chat-footer {
                padding: 1.5rem 1rem;
            }

            .footer-link {
                width: 36px;
                height: 36px;
            }

            .footer-link svg {
                width: 18px;
                height: 18px;
            }

            .footer-logo {
                width: 38px;
                height: 38px;
            }

            .footer-text {
                font-size: 0.75rem;
            }

            .footer-copyright {
                font-size: 0.7rem;
            }
        }

        /* Light Mode Styles */
        body.light-mode {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --bg-tertiary: #e8e8e8;
            --text-primary: #000000;
            --text-secondary: #333333;
            --text-muted: #666666;
            --border: #d0d0d0;
            --border-light: #e0e0e0;
            --accent: #000000;
            --accent-hover: #333333;
        }

        body.light-mode .sidebar {
            background: #f8f8f8;
        }

        body.light-mode .main-content {
            background: var(--bg-primary);
        }

        body.light-mode .page {
            background: var(--bg-primary);
        }

        body.light-mode h1,
        body.light-mode h2,
        body.light-mode h3,
        body.light-mode a {
            color: var(--accent) !important;
        }

        body.light-mode .sidebar-footer a {
            color: var(--text-secondary);
        }

        body.light-mode .sidebar-footer a:hover {
            color: var(--accent);
            background: var(--bg-tertiary);
        }

        body.light-mode .info-card {
            background: var(--bg-tertiary);
            border-color: var(--border);
        }

        body.light-mode .info-card:hover {
            border-color: var(--accent);
        }
    </style>
</head>

<body>
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebar-overlay" onclick="closeSidebar()"></div>

    <!-- Left Sidebar -->
    <aside class="sidebar" id="sidebar">
        <!-- Sidebar Handle -->
        <div class="sidebar-handle" onclick="toggleSidebar()" title="Open sidebar">
            <svg viewBox="0 0 60 80" xmlns="http://www.w3.org/2000/svg">
                <!-- Bot Antennas -->
                <g class="bot-antennas">
                    <line x1="22" y1="8" x2="22" y2="12" stroke="#e5ff3a" stroke-width="2" stroke-linecap="round"/>
                    <circle cx="22" cy="8" r="2" fill="#e5ff3a"/>
                    <line x1="38" y1="8" x2="38" y2="12" stroke="#e5ff3a" stroke-width="2" stroke-linecap="round"/>
                    <circle cx="38" cy="8" r="2" fill="#e5ff3a"/>
                </g>
                <!-- Bot Head (square, peeking from sidebar) -->
                <g class="bot-head">
                    <rect x="12" y="12" width="36" height="36" rx="3" fill="#e5ff3a" stroke="#121212" stroke-width="2"/>
                    <circle cx="24" cy="24" r="3" fill="#121212" class="bot-eye"/>
                    <circle cx="36" cy="24" r="3" fill="#121212" class="bot-eye"/>
                    <rect x="26" y="32" width="8" height="2" rx="1" fill="#121212"/>
                </g>
                <!-- Bot Body (behind sidebar) -->
                <rect x="15" y="48" width="30" height="25" rx="5" fill="#e5ff3a" stroke="#121212" stroke-width="2"/>
                <rect x="20" y="53" width="20" height="15" rx="2" fill="#121212" opacity="0.3"/>
                <!-- Right Hand (hanging on edge) -->
                <g class="bot-hand-right">
                    <rect x="52" y="58" width="8" height="20" rx="4" fill="#e5ff3a" stroke="#121212" stroke-width="2"/>
                    <circle cx="56" cy="60" r="2" fill="#121212"/>
                </g>
            </svg>
        </div>
        <div class="sidebar-header">
            <img src="ghost.JPG" alt="Logo" onerror="this.style.display='none'">
            <h1>Uncensored InfiNet AI</h1>
        </div>

        <div class="sidebar-actions">
            <button class="btn-go-uncensored" onclick="goToChat()">Go Uncensored</button>
        </div>

        <div class="sidebar-conversations" id="conversations">
            <!-- Conversations will be added here -->
        </div>

        <!-- Info Cards in Sidebar -->
        <div class="sidebar-info-cards">
            <div class="info-card" onmouseenter="showExpandedCard('privacy')" onmouseleave="hideExpandedCard('privacy')"
                ontouchstart="toggleExpandedCard('privacy')" onclick="toggleExpandedCard('privacy')">
                <h4>
                    <svg class="lock-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"
                            fill="currentColor" />
                    </svg>
                    100% Private
                </h4>
                <p>Chats & images deleted automatically</p>
                <div class="info-card-expanded" id="privacy-expanded">
                    <div class="info-card-expanded-header">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"
                                fill="currentColor" />
                        </svg>
                        <h5>100% Private</h5>
                    </div>
                    <p>All your conversations and generated images are automatically and permanently deleted after 24
                        hours. We don't store your data - your privacy is our top priority.</p>
                </div>
            </div>
        </div>

        <div class="sidebar-footer">
             <a href="/profile" id="sidebar-profile-link" onclick="handleProfileLinkClick(event)">
                <svg class="sidebar-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
                        fill="currentColor" />
                </svg>
                <span id="sidebar-profile-text">Profile</span>
            </a>
            <a href="/pricing">
                <svg class="sidebar-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"
                        fill="currentColor" />
                </svg>
                Pricing
            </a>
            <a href="/features">
                <svg class="sidebar-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"
                        fill="currentColor" />
                </svg>
                Features
            </a>
            <a href="/doc">
                <svg class="sidebar-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"
                        fill="currentColor" />
                </svg>
                Documentation
            </a>
        </div>

        <div class="sidebar-socials">
            <div class="sidebar-cta-wrapper">
                <a class="sidebar-cta" href="#" id="sidebar-apk-btn" title="APK (Coming Soon)">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M17.523 15.3414c-.5511 0-.9993-.4486-.9993-.9997s.4482-.9993.9993-.9993c.5506 0 .9993.4486.9993.9993.0001.5511-.4486.9997-.9993.9997m-11.046 0c-.5511 0-.9993-.4486-.9993-.9997s.4486-.9993.9993-.9993c.5506 0 .9993.4486.9993.9993 0 .5511-.4486.9997-.9993.9997m11.4045-6.02l1.9973-3.4592a.416.416 0 00-.1521-.5676.416.416 0 00-.5676.1521l-2.0223 3.503C15.5902 8.2439 13.8533 7.8508 12 7.8508s-3.5902.3931-5.1349 1.0989L4.8429 5.4467a.4161.4161 0 00-.5676-.1521.4157.4157 0 00-.1521.5676l1.9973 3.4592C2.6889 11.186.8533 13.2177.8533 15.7404v.9225c0 .2768.2232.5.5.5h22.2934c.2768 0 .5-.2232.5-.5v-.9225c0-2.5227-1.8356-4.5536-4.2668-5.419"
                            fill="currentColor" />
                    </svg>
                    APK
                </a>
                <a href="/privacy" class="sidebar-link-text">Policy</a>
            </div>
            <div class="sidebar-cta-wrapper">
                <a class="sidebar-cta" href="#" id="sidebar-web-btn" onclick="handleWebAppInstall(event)" title="Add to Home Screen">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 14H4v-4h11v4zm0-5H4V9h11v4zm5 5h-4V9h4v9z"
                            fill="currentColor" />
                    </svg>
                    Web
                </a>
                <a href="/terms" class="sidebar-link-text">Terms</a>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="page">
            <div class="header">
                <h1>Choose Your Plan</h1>
                <p>Simple pricing for every need.</p>
            </div>

            <!-- Token Usage Display -->
            <div id="token-usage-wrapper" style="display: none;">
                <h2 class="token-usage-title">Token Usage</h2>
                <div id="token-usage-section" class="token-usage-section">
                    <div class="token-usage-header">
                        <div class="token-usage-stats">
                            <span id="token-percentage">0%</span> Used •
                            <span id="token-remaining">Remaining Credits</span>
                        </div>
                    </div>
                    <div class="token-usage-bar-container">
                        <div class="token-usage-bar">
                            <div id="token-usage-bar-fill" class="token-usage-bar-fill"></div>
                        </div>
                    </div>
                    <div class="token-usage-numbers">
                        <span id="token-used">0</span> / <span id="token-total">0</span>
                    </div>
                </div>
            </div>

            <div class="plans">
                <div class="plan muted">
                    <h2>Free</h2>
                    <div class="price">$0 <span>/ 10K Tokens</span></div>
                    <ul class="features">
                        <li>Testing Access</li>
                        <li>Limited History</li>
                        <li>Ideal for Testing</li>
                    </ul>
                    <button class="cta" id="free-plan-btn" onclick="handleFreePlanClick()">Get Started</button>
                </div>

                 <div class="plan">
                    <h2>Lite</h2>
                    <div class="price">$9 <span>/ 25K Tokens</span></div>
                    <ul class="features">
                        <li>Basic Access</li>
                        <li>Extended History</li>
                        <li>Ideal for Exploration</li>
                    </ul>
                    <button class="cta">Subscribe</button>
                </div>

                <div class="plan">
                    <h2>Pro</h2>
                    <div class="price">$29 <span>/ 100K Tokens</span></div>
                    <ul class="features">
                        <li>Extended Access</li>
                        <li>Extended History</li>
                        <li>Perfect for Regular Use</li>
                    </ul>
                    <button class="cta">Subscribe</button>
                </div>

                <div class="plan">
                    <h2>Ultra</h2>
                    <div class="price">$59 <span>/ 250K Tokens</span></div>
                    <ul class="features">
                        <li>Premium Access</li>
                        <li>Unlimited History</li>
                        <li>Ideal for Power Users</li>
                    </ul>
                    <button class="cta">Subscribe</button>
                </div>

            </div>
        </div>

        <!-- Footer -->
        <footer class="chat-footer">
            <a href="https://infinet.services/" target="_blank" class="footer-link footer-link-left"
                title="Visit InfiNet Services">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM18.92 8h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H4.26c.96-1.66 2.49-2.93 4.33-3.56C8.03 5.55 7.57 6.75 7.25 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.34.16-2h4.68c.09.66.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"
                        fill="currentColor" />
                </svg>
            </a>
            <div class="footer-center">
                <p class="footer-text">Powered by <img src="logo.PNG" alt="InfiNet Logo" class="footer-logo"
                        onerror="this.style.display='none'"></p>
                <p class="footer-copyright">© 2025 InfiNet AI. All rights reserved.</p>
            </div>
            <a href="mailto:admin@infinet.services" class="footer-link footer-link-right" title="Contact Us">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"
                        fill="currentColor" />
                </svg>
            </a>
        </footer>
    </main>

    <script>
        // Web App Install Handler - Define early to ensure it's available
        let deferredPrompt = null;

        function handleWebAppInstall(event) {
            event.preventDefault();
            
            // Check if already installed
            if (window.matchMedia('(display-mode: standalone)').matches || 
                window.navigator.standalone === true) {
                alert('This app is already installed on your device!');
                return;
            }

            // Check if browser supports install prompt
            if (deferredPrompt) {
                // Show the install prompt
                deferredPrompt.prompt();
                
                // Wait for the user to respond to the prompt
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    } else {
                        console.log('User dismissed the install prompt');
                    }
                    deferredPrompt = null;
                });
            } else {
                // Fallback for browsers that don't support beforeinstallprompt
                // Show instructions based on device
                const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
                const isAndroid = /Android/.test(navigator.userAgent);
                
                if (isIOS) {
                    alert('To install this app:\n1. Tap the Share button\n2. Select "Add to Home Screen"\n3. Tap "Add"');
                } else if (isAndroid) {
                    alert('To install this app:\n1. Tap the menu (3 dots) in your browser\n2. Select "Add to Home Screen" or "Install App"\n3. Tap "Add" or "Install"');
                } else {
                    alert('To install this app:\n1. Look for the install icon in your browser\'s address bar\n2. Click it and follow the prompts\n\nOr use your browser\'s menu to find "Install" or "Add to Home Screen"');
                }
            }
        }

        window.handleWebAppInstall = handleWebAppInstall;

        // Listen for the beforeinstallprompt event
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;
            
            // Update button text/title to indicate install is available
            const webBtn = document.getElementById('sidebar-web-btn');
            if (webBtn) {
                webBtn.title = 'Add to Home Screen';
            }
        });

        // Listen for app installed event
        window.addEventListener('appinstalled', () => {
            console.log('PWA was installed');
            deferredPrompt = null;
            
            // Update button to show it's installed
            const webBtn = document.getElementById('sidebar-web-btn');
            if (webBtn) {
                webBtn.title = 'App Installed';
            }
        });

        // API Base URL
        const API_BASE = window.location.origin;
        
        // Authentication State
        let isAuthenticated = false;
        let currentUser = null;
        
        // Check authentication
        async function checkAuth() {
            try {
                const response = await fetch(`${API_BASE}/api/user/me`, {
                    credentials: 'include'
                });
                
                if (response.ok) {
                    const userData = await response.json();
                    currentUser = {
                        id: userData.id,
                        email: userData.email,
                        name: userData.displayName || userData.email.split('@')[0],
                        displayName: userData.displayName
                    };
                    isAuthenticated = true;
                    return true;
                } else {
                    isAuthenticated = false;
                    currentUser = null;
                    return false;
                }
            } catch (error) {
                console.error('Auth check error:', error);
                isAuthenticated = false;
                currentUser = null;
                return false;
            }
        }
        
        // Update sidebar profile link based on auth status
        function updateSidebarProfileLink() {
            const profileLink = document.getElementById('sidebar-profile-link');
            const profileText = document.getElementById('sidebar-profile-text');
            
            if (!profileLink || !profileText) return;
            
            if (isAuthenticated && currentUser) {
                profileLink.href = '/profile';
                profileText.textContent = 'Profile';
            } else {
                profileLink.href = '/#auth';
                profileText.textContent = 'Hop In';
            }
        }
        
        // Handle profile link click
        function handleProfileLinkClick(event) {
            if (!isAuthenticated || !currentUser) {
                event.preventDefault();
                // Redirect to index with auth hash
                window.location.href = '/#auth';
            }
            // If authenticated, let the default link behavior work
        }
        
        // Load token usage (for both authenticated and non-authenticated users)
        async function loadTokenUsage() {
            try {
                let response;
                if (isAuthenticated && currentUser) {
                    response = await fetch(`${API_BASE}/api/user/tokens`, {
                        credentials: 'include'
                    });
                } else {
                    response = await fetch(`${API_BASE}/api/tokens/ip`, {
                        credentials: 'include'
                    });
                }

                if (response.ok) {
                    const data = await response.json();
                    const tokensRemaining = data.tokens || 0;
                    const tokensTotal = data.tokensAllocated || 0;
                    const tokensUsed = tokensTotal - tokensRemaining;
                    const percentage = tokensTotal > 0 ? Math.round((tokensUsed / tokensTotal) * 100) : 0;

                    document.getElementById('token-percentage').textContent = percentage + '%';
                    document.getElementById('token-used').textContent = tokensUsed.toLocaleString();
                    document.getElementById('token-total').textContent = tokensTotal.toLocaleString();
                    document.getElementById('token-remaining').textContent = `Remaining Credits: ${tokensRemaining.toLocaleString()}`;
                    document.getElementById('token-usage-bar-fill').style.width = percentage + '%';
                    document.getElementById('token-usage-wrapper').style.display = 'block';
                } else {
                    document.getElementById('token-usage-wrapper').style.display = 'none';
                }
            } catch (error) {
                console.error('Error loading token usage:', error);
                document.getElementById('token-usage-section').style.display = 'none';
            }
        }

        // Handle Free Plan button click
        function handleFreePlanClick() {
            if (isAuthenticated && currentUser) {
                // User is signed in - show "Subscribed" (or handle subscription logic)
                const btn = document.getElementById('free-plan-btn');
                if (btn) {
                    btn.textContent = 'Subscribed';
                    btn.disabled = true;
                    btn.style.opacity = '0.6';
                    btn.style.cursor = 'not-allowed';
                }
            } else {
                // User not signed in - redirect to auth modal
                window.location.href = '/#auth';
            }
        }

        // Update Free Plan button based on auth status
        function updateFreePlanButton() {
            const btn = document.getElementById('free-plan-btn');
            if (!btn) return;

            if (isAuthenticated && currentUser) {
                // Check if user has free plan
                // For now, just show "Subscribed" if authenticated
                btn.textContent = 'Subscribed';
                btn.disabled = true;
                btn.style.opacity = '0.6';
                btn.style.cursor = 'not-allowed';
            } else {
                btn.textContent = 'Get Started';
                btn.disabled = false;
                btn.style.opacity = '1';
                btn.style.cursor = 'pointer';
            }
        }

        // Initialize auth check
        (async function init() {
            await checkAuth();
            updateSidebarProfileLink();
            updateFreePlanButton();
            await loadTokenUsage();
        })();
        
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');

            const isOpen = sidebar.classList.contains('sidebar-open');

            if (isOpen) {
                sidebar.classList.remove('sidebar-open');
                sidebar.classList.add('mobile-hidden');
                overlay.classList.remove('show');
            } else {
                sidebar.classList.remove('mobile-hidden');
                sidebar.classList.add('sidebar-open');
                overlay.classList.add('show');
            }
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');

            sidebar.classList.remove('sidebar-open');
            sidebar.classList.add('mobile-hidden');
            overlay.classList.remove('show');
        }

        let activeExpandedCard = null;
        function showExpandedCard(type) {
            if ('ontouchstart' in window) return;
            const expanded = document.getElementById(type + '-expanded');
            if (expanded) {
                expanded.classList.add('show');
                activeExpandedCard = type;
                const parentCard = expanded.closest('.info-card');
                if (parentCard) parentCard.classList.add('expanded-active');
            }
        }
        function hideExpandedCard(type) {
            if ('ontouchstart' in window) return;
            const expanded = document.getElementById(type + '-expanded');
            if (expanded && activeExpandedCard === type) {
                expanded.classList.remove('show');
                activeExpandedCard = null;
                const parentCard = expanded.closest('.info-card');
                if (parentCard) parentCard.classList.remove('expanded-active');
            }
        }
        function toggleExpandedCard(type) {
            const expanded = document.getElementById(type + '-expanded');
            if (expanded) {
                if (activeExpandedCard && activeExpandedCard !== type) {
                    const otherExpanded = document.getElementById(activeExpandedCard + '-expanded');
                    if (otherExpanded) {
                        otherExpanded.classList.remove('show');
                        const otherParentCard = otherExpanded.closest('.info-card');
                        if (otherParentCard) otherParentCard.classList.remove('expanded-active');
                    }
                }
                const parentCard = expanded.closest('.info-card');
                expanded.classList.toggle('show');
                if (expanded.classList.contains('show')) {
                    activeExpandedCard = type;
                    if (parentCard) parentCard.classList.add('expanded-active');
                } else {
                    activeExpandedCard = null;
                    if (parentCard) parentCard.classList.remove('expanded-active');
                }
            }
        }

        function goToChat() {
            window.location.href = '/';
        }

        async function deleteConversation(convId) {
            try {
                const response = await fetch(`${API_BASE}/api/conversations/${convId}`, {
                    method: 'DELETE',
                    credentials: 'include'
                });
                
                if (!response.ok) {
                    throw new Error('Failed to delete conversation');
                }
                
                await loadConversations();
            } catch (error) {
                console.error('Error deleting conversation:', error);
                // Fallback to localStorage
                let conversations = JSON.parse(localStorage.getItem('conversations') || '[]');
                conversations = conversations.filter(conv => conv.id !== convId);
                localStorage.setItem('conversations', JSON.stringify(conversations));
                loadConversations();
            }
        }

        async function loadConversations() {
            try {
                const response = await fetch(`${API_BASE}/api/conversations`, {
                    credentials: 'include'
                });
                
                if (!response.ok) {
                    throw new Error('Failed to load conversations');
                }
                
                const data = await response.json();
                const conversations = data.conversations || [];
                const container = document.getElementById('conversations');
                if (!container) return;
                container.innerHTML = '';

                if (conversations.length === 0) {
                    const emptyDiv = document.createElement('div');
                    emptyDiv.style.padding = '0';
                    emptyDiv.style.color = 'var(--text-muted)';
                    emptyDiv.style.fontSize = '0.85rem';
                    emptyDiv.style.textAlign = 'center';
                    emptyDiv.textContent = 'No conversations yet';
                    container.appendChild(emptyDiv);
                    return;
                }

                conversations.forEach(conv => {
                    const item = document.createElement('div');
                    item.className = 'conversation-item';
                    // Use title if available, otherwise use first message content, otherwise "New Chat"
                    let preview = 'New Chat';
                    if (conv.title && conv.title !== 'New Chat' && conv.title.trim() !== '') {
                        preview = conv.title;
                    } else if (conv.messages && conv.messages.length > 0 && conv.messages[0].content) {
                        preview = conv.messages[0].content.substring(0, 30) + '...';
                    }

                    const content = document.createElement('div');
                    content.className = 'conversation-item-content';
                    content.textContent = preview;
                    content.onclick = () => {
                        localStorage.setItem('selectedConversationId', conv.id);
                        window.location.href = '/';
                    };

                    const deleteBtn = document.createElement('button');
                    deleteBtn.className = 'conversation-delete-btn';
                    deleteBtn.innerHTML = '<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" fill="currentColor"/></svg>';
                    deleteBtn.onclick = (e) => {
                        e.stopPropagation();
                        deleteConversation(conv.id);
                    };
                    deleteBtn.title = 'Delete conversation';

                    item.appendChild(content);
                    item.appendChild(deleteBtn);
                    container.appendChild(item);
                });
            } catch (error) {
                console.error('Error loading conversations:', error);
                // Fallback to localStorage
                const conversations = JSON.parse(localStorage.getItem('conversations') || '[]');
                const container = document.getElementById('conversations');
                if (!container) return;
                container.innerHTML = '';
                if (conversations.length === 0) {
                    const emptyDiv = document.createElement('div');
                    emptyDiv.style.padding = '0';
                    emptyDiv.style.color = 'var(--text-muted)';
                    emptyDiv.style.fontSize = '0.85rem';
                    emptyDiv.style.textAlign = 'center';
                    emptyDiv.textContent = 'No conversations yet';
                    container.appendChild(emptyDiv);
                    return;
                }
                conversations.forEach(conv => {
                    const item = document.createElement('div');
                    item.className = 'conversation-item';
                    let preview = 'New Chat';
                    if (conv.title && conv.title !== 'New Chat' && conv.title.trim() !== '') {
                        preview = conv.title;
                    } else if (conv.messages && conv.messages.length > 0 && conv.messages[0].content) {
                        preview = conv.messages[0].content.substring(0, 30) + '...';
                    }
                    const content = document.createElement('div');
                    content.className = 'conversation-item-content';
                    content.textContent = preview;
                    content.onclick = () => {
                        localStorage.setItem('selectedConversationId', conv.id);
                        window.location.href = '/';
                    };
                    const deleteBtn = document.createElement('button');
                    deleteBtn.className = 'conversation-delete-btn';
                    deleteBtn.innerHTML = '<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" fill="currentColor"/></svg>';
                    deleteBtn.onclick = (e) => {
                        e.stopPropagation();
                        deleteConversation(conv.id);
                    };
                    deleteBtn.title = 'Delete conversation';
                    item.appendChild(content);
                    item.appendChild(deleteBtn);
                    container.appendChild(item);
                });
            }
        }

        // Initialize sidebar for mobile
        if (window.innerWidth <= 768) {
            document.getElementById('sidebar').classList.add('mobile-hidden');
        }
        window.addEventListener('resize', function () {
            if (window.innerWidth > 768) {
                document.getElementById('sidebar').classList.remove('mobile-hidden');
                document.getElementById('sidebar-overlay').classList.remove('show');
            } else {
                document.getElementById('sidebar').classList.add('mobile-hidden');
            }
        });

        // Hide toggle button when scrolling down
        const mainContent = document.querySelector('.main-content');
        const menuToggle = document.getElementById('menu-toggle');

        if (mainContent && menuToggle) {
            mainContent.addEventListener('scroll', function () {
                const scrollTop = mainContent.scrollTop;

                if (scrollTop > 100) {
                    // Scrolled down - hide toggle button
                    menuToggle.style.opacity = '0';
                    menuToggle.style.pointerEvents = 'none';
                } else {
                    // At the top - show toggle button
                    menuToggle.style.opacity = '1';
                    menuToggle.style.pointerEvents = 'auto';
                }
            });
        }

        loadConversations();

        // Update theme-color meta tag
        function updateThemeColor(isLight) {
            let themeColorMeta = document.querySelector('meta[name="theme-color"]');
            let appleStatusBarMeta = document.querySelector('meta[name="apple-mobile-web-app-status-bar-style"]');
            
            if (!themeColorMeta) {
                themeColorMeta = document.createElement('meta');
                themeColorMeta.setAttribute('name', 'theme-color');
                document.head.appendChild(themeColorMeta);
            }
            
            if (!appleStatusBarMeta) {
                appleStatusBarMeta = document.createElement('meta');
                appleStatusBarMeta.setAttribute('name', 'apple-mobile-web-app-status-bar-style');
                document.head.appendChild(appleStatusBarMeta);
            }
            
            if (isLight) {
                themeColorMeta.setAttribute('content', '#ffffff');
                appleStatusBarMeta.setAttribute('content', 'default');
            } else {
                themeColorMeta.setAttribute('content', '#000000');
                appleStatusBarMeta.setAttribute('content', 'black');
            }
        }

        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');

            if (body.classList.contains('light-mode')) {
                body.classList.remove('light-mode');
                // Moon icon for dark mode (crescent moon)
                themeIcon.innerHTML = '<path d="M21.64 13a1 1 0 0 0-1.05-.14 8.05 8.05 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36 10.14 10.14 0 1 0 22 14.05 1 1 0 0 0 21.64 13Z" fill="currentColor"/>';
                localStorage.setItem('theme', 'dark');
                updateThemeColor(false);
            } else {
                body.classList.add('light-mode');
                // Sun icon for light mode
                themeIcon.innerHTML = '<circle cx="12" cy="12" r="5" fill="currentColor"/><path d="M12 1V3M12 21V23M4.22 4.22L5.64 5.64M18.36 18.36L19.78 19.78M1 12H3M21 12H23M4.22 19.78L5.64 18.36M18.36 5.64L19.78 4.22" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/>';
                localStorage.setItem('theme', 'light');
                updateThemeColor(true);
            }
        }

        // Load saved theme on page load
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            const themeIcon = document.getElementById('theme-icon');

            if (savedTheme === 'light') {
                document.body.classList.add('light-mode');
                // Sun icon for light mode
                themeIcon.innerHTML = '<circle cx="12" cy="12" r="5" fill="currentColor"/><path d="M12 1V3M12 21V23M4.22 4.22L5.64 5.64M18.36 18.36L19.78 19.78M1 12H3M21 12H23M4.22 19.78L5.64 18.36M18.36 5.64L19.78 4.22" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/>';
                updateThemeColor(true);
            } else {
                document.body.classList.remove('light-mode');
                // Moon icon for dark mode (crescent moon)
                themeIcon.innerHTML = '<path d="M21.64 13a1 1 0 0 0-1.05-.14 8.05 8.05 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36 10.14 10.14 0 1 0 22 14.05 1 1 0 0 0 21.64 13Z" fill="currentColor"/>';
                updateThemeColor(false);
            }
        }

        // Load theme when page loads
        loadTheme();

        // Mobile browser UI hiding - hide bottom tab on scroll
        (function () {
            function isMobile() {
                return window.innerWidth <= 768;
            }

            // Browser UI hiding happens automatically when window scrolls
            // Just ensure the page is scrollable
            if (isMobile()) {
                // Add padding at bottom to ensure scrollability
                document.body.style.paddingBottom = 'env(safe-area-inset-bottom, 0px)';
            }
        })();
    </script>
</body>

</html>